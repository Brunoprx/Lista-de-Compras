<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minha Lista de Compras</title>
    <link rel="icon" type="image/png" href="icone.png">
    
    <link rel="apple-touch-icon" href="icone.png">
    
    <style>
        /* --- ESTILO (CSS) --- */
        
        * { box-sizing: border-box; }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 15px;
            background-color: #f4f4f4;
            /* Garante que a p√°gina tenha altura m√≠nima para n√£o cortar conte√∫do */
            min-height: 100vh;
            padding-bottom: 80px; /* Espa√ßo extra no final para o bot√£o n√£o colar na borda */
        }

        h1 {
            text-align: center;
            color: #ea1d2c;
            margin-top: 0;
            font-size: 24px;
        }

        /* √Årea de input */
        .input-group {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            width: 100%;
        }

        input[type="text"] {
            flex: 1;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            min-width: 0;
        }

        input[type="number"] {
            width: 50px;
            padding: 12px 5px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
        }

        button#add-btn {
            padding: 0 15px;
            background-color: #ea1d2c;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            flex-shrink: 0;
            height: 45px;
        }

        /* Lista */
        ul { list-style-type: none; padding: 0; }

        li {
            background: white;
            margin-bottom: 10px;
            padding: 10px;
            display: flex;
            align-items: center;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            justify-content: space-between;
        }

        .item-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            overflow: hidden;
            cursor: pointer;
        }

        /* Checkbox */
        .custom-checkbox {
            width: 22px;
            height: 22px;
            border: 2px solid #ea1d2c;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            flex-shrink: 0;
        }

        .item-qtd {
            font-size: 13px;
            color: #666;
            background-color: #eee;
            padding: 2px 6px;
            border-radius: 6px;
            flex-shrink: 0;
            white-space: nowrap;
        }

        .item-text {
            font-size: 16px;
            color: #333;
            word-break: break-word;
        }

        /* Estados Marcados */
        li.checked { background-color: #f9f9f9; }
        li.checked .custom-checkbox { background-color: #ea1d2c; }
        li.checked .custom-checkbox::after { content: '‚úì'; }
        li.checked .item-text { text-decoration: line-through; color: #aaa; }

        .delete-btn {
            background-color: transparent;
            border: none;
            color: #bbb;
            font-size: 18px;
            padding: 8px;
            margin-left: 5px;
            cursor: pointer;
            flex-shrink: 0;
        }

        /* Bot√£o Limpar Conclu√≠dos */
        .btn-limpar-container {
            text-align: center;
            margin-top: 30px;
        }
        
        .btn-limpar {
            background-color: white; 
            border: 1px solid #ea1d2c; 
            color: #ea1d2c; 
            padding: 12px 24px; 
            border-radius: 8px; 
            font-size: 14px; 
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: background 0.2s;
        }
        
        .btn-limpar:active {
            background-color: #ffe5e5;
        }

        /* --- ESTILO DO MODAL --- */
        #modalConfirmacao {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 25px;
            border-radius: 12px;
            width: 85%;
            max-width: 320px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: aparecer 0.2s ease-out; /* Pequena anima√ß√£o ao abrir */
        }
        
        @keyframes aparecer {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-content h3 { margin-top: 0; color: #333; font-size: 18px; }
        .modal-content p { color: #666; margin-bottom: 25px; line-height: 1.4; }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .btn-modal {
            padding: 12px 0;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            flex: 1;
            font-weight: bold;
        }

        .btn-cancel { background-color: #eee; color: #555; }
        .btn-confirm { background-color: #ea1d2c; color: white; }

    </style>
</head>
<body>

    <h1>üõí Minha Lista</h1>

    <div class="input-group">
        <input type="number" id="qtdInput" value="1" min="1">
        <input type="text" id="itemInput" placeholder="Produto...">
        <button id="add-btn" onclick="novoItem()">Adicionar</button>
    </div>

    <ul id="minhaLista">
        </ul>

    <div class="btn-limpar-container">
        <button class="btn-limpar" onclick="tentarLimparConcluidos()">
            üßπ Limpar itens marcados
        </button>
    </div>

    <div id="modalConfirmacao">
        <div class="modal-content">
            <h3 id="modalTitulo">Tem a certeza?</h3>
            <p id="modalDescricao">Quer mesmo remover este item?</p>
            <div class="modal-buttons">
                <button class="btn-modal btn-cancel" onclick="fecharModal()">Cancelar</button>
                <button class="btn-modal btn-confirm" onclick="confirmarAcao()">Sim</button>
            </div>
        </div>
    </div>

    <script>
        /* --- L√ìGICA (JAVASCRIPT) --- */
        
        let acaoPendente = null; // 'deletar_um' ou 'limpar_tudo'
        let itemAlvo = null; // Guarda o item espec√≠fico se for para deletar apenas um

        document.addEventListener("DOMContentLoaded", carregarLista);

        // --- Adicionar Item ---
        function novoItem() {
            let inputNome = document.getElementById("itemInput");
            let inputQtd = document.getElementById("qtdInput");
            let nome = inputNome.value;
            let qtd = inputQtd.value;

            if (nome === '') { alert("Escreva o produto!"); return; }
            if (qtd === '' || qtd < 1) { qtd = 1; }

            criarElementoNaTela(nome, qtd, false);
            salvarNoNavegador();
            
            inputNome.value = "";
            inputQtd.value = "1";
            inputNome.focus();
        }

        // --- Criar Visual do Item ---
        function criarElementoNaTela(texto, quantidade, feito) {
            let li = document.createElement("li");
            if (feito) { li.classList.add('checked'); }

            let checkboxDiv = document.createElement("div");
            checkboxDiv.className = "custom-checkbox";

            let spanTexto = document.createElement("span");
            spanTexto.className = "item-text";
            spanTexto.innerText = texto;

            let spanQtd = document.createElement("span");
            spanQtd.className = "item-qtd";
            spanQtd.innerText = quantidade + "x";

            let divInfo = document.createElement("div");
            divInfo.className = "item-info";
            divInfo.appendChild(checkboxDiv);
            divInfo.appendChild(spanQtd);
            divInfo.appendChild(spanTexto);
            
            divInfo.onclick = function() {
                li.classList.toggle('checked');
                salvarNoNavegador();
            };

            let btnDelete = document.createElement("button");
            btnDelete.innerHTML = "üóëÔ∏è";
            btnDelete.className = "delete-btn";
            
            // Ao clicar no lixo, preparamos o modal para apagar UM item
            btnDelete.onclick = function() {
                acaoPendente = 'deletar_um';
                itemAlvo = li;
                abrirModal("Remover Item", "Deseja remover este item da lista?");
            };

            li.appendChild(divInfo);
            li.appendChild(btnDelete);
            document.getElementById("minhaLista").appendChild(li);
        }

        // --- Bot√£o de Limpar Conclu√≠dos ---
        function tentarLimparConcluidos() {
            let lista = document.getElementById("minhaLista");
            let temMarcado = false;

            // Verifica se existe algum item marcado
            for (let i = 0; i < lista.children.length; i++) {
                if (lista.children[i].classList.contains('checked')) {
                    temMarcado = true;
                    break;
                }
            }

            if (!temMarcado) {
                // Se n√£o tiver nada marcado, n√£o abrimos o modal
                alert("N√£o h√° itens marcados para limpar!");
                return;
            }

            // Se tiver, preparamos o modal para LIMPAR TUDO
            acaoPendente = 'limpar_tudo';
            abrirModal("Limpar Lista", "Deseja apagar todos os itens que j√° comprou?");
        }

        // --- Fun√ß√µes do Modal ---
        function abrirModal(titulo, texto) {
            document.getElementById('modalTitulo').innerText = titulo;
            document.getElementById('modalDescricao').innerText = texto;
            document.getElementById('modalConfirmacao').style.display = 'flex';
        }

        function fecharModal() {
            document.getElementById('modalConfirmacao').style.display = 'none';
            acaoPendente = null;
            itemAlvo = null;
        }

        function confirmarAcao() {
            if (acaoPendente === 'deletar_um' && itemAlvo) {
                itemAlvo.remove();
            } 
            else if (acaoPendente === 'limpar_tudo') {
                let lista = document.getElementById("minhaLista");
                let itens = lista.children;
                // Loop reverso para apagar sem quebrar o √≠ndice
                for (let i = itens.length - 1; i >= 0; i--) {
                    if (itens[i].classList.contains('checked')) {
                        itens[i].remove();
                    }
                }
            }
            
            salvarNoNavegador();
            fecharModal();
        }

        // --- Armazenamento (LocalStorage) ---
        function salvarNoNavegador() {
            let lista = document.getElementById("minhaLista");
            let itens = [];
            for (let i = 0; i < lista.children.length; i++) {
                let li = lista.children[i];
                let texto = li.querySelector(".item-text").innerText;
                let qtdText = li.querySelector(".item-qtd").innerText;
                let qtd = qtdText.replace("x", "");
                let estaMarcado = li.classList.contains('checked');
                itens.push({ texto: texto, quantidade: qtd, feito: estaMarcado });
            }
            localStorage.setItem("minhaListaComprasV2", JSON.stringify(itens));
        }

        function carregarLista() {
            let dados = localStorage.getItem("minhaListaComprasV2");
            if (dados) {
                let itens = JSON.parse(dados);
                itens.forEach(item => {
                    criarElementoNaTela(item.texto, item.quantidade, item.feito);
                });
            }
        }
    </script>
</body>
</html>

